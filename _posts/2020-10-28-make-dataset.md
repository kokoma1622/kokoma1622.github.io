---
title: "[ML] Make Dataset"
date: 2020-10-28 20:55:33 -0400
categories: MachineLearning,DataPreprocessing
---

수치 데이터를 막대그래프로 변형하여 이미지로 만들기로 정하였다.
이미지의 크기는 28x28로 하려 하였으나, 일단 14x14로 축소하여 만들고 필요하면 상하좌우로 확장하여 쓰기로 하였다.

막대는 cs, 레벨, 킬, 데스, 어시스트로 다섯 개.
cs는 분당 cs 3개~11개를 기준으로, 나머지는 10명의 최솟값-1과 최댓값을 기준으로 높이 12의 막대로 변환하였다.
(처음 28x28 크기의 막대그래프를 만들 때, 높이를 24로 해야하는데 12로 만들어 다시 만드는 과정을 거쳤다. 내 시간 ㅜㅜ)

챔피언 데이터는 막대의 배경에 사용하였다.
152개의 챔피언을 10~161 범위의 정수로 랜덤하게 링크한 후, 
블루팀 유저는 배경의 짝수 행에, 레드팀 유저는 배경의 홀수 행에 입력하였다.
처음에 데이터셋을 만들 때에는 champ to int randomized dictionary를 별도로 저장하지 않았는데,
나중에 테스트 데이터셋과 별개로 사용자 지정 입력을 만들 때 문제가 되어,
random dictionary를 같이 저장하는 데이터셋을 만들었다.

패치 버전과 분 데이터는 14x14 크기의 같은 숫자를 가지는 이미지로 일단 추가하여 같이 저장하였다.
즉 원본 데이터는 data_length x 14x14x12의 크기로 설정되었다.
다만 나중에 러닝을 위해 모델을 설계할 때, input channel의 개수를 12개로 유지할 수도 있고,
패치 버전과 분을 따로 분리하여 별도의 입력으로 사용할 수도 있다.

실험에 사용한 학습 데이터셋은 패치 버전 당 10k개의 게임에서 분 데이터 중 5개를 임의추출하여,
버전 당 50k개의 데이터로 10.1 버전부터 10.20 버전까지 총 1M개를 가지는 학습 데이터셋을 만들었다.
또한 버전 당 5k개의 게임에서 분 데이터 1개를 임의추출하여 총 100k개의 테스트 데이터셋을 만들었다.
데이터 수가 더 필요하다면 버전 당 15k ~ 20k 개의 게임에서 분 데이터 10개를 임의추출 하는 등으로
중복 없이 학습 데이터셋의 개수를 늘릴 수 있다.

위와 같은 방식으로 데이터셋을 만들 때 단점은 분(minute)의 분포가 일정하지 않다는 것이다.
끝나는 시간이 게임에 따라 다르다보니, 경기 후반에 해당하는 분 데이터는 경기 초반 데이터에 비해 상대적으로 수가 적을 것이다.
또한 경기 극초반 라인전 단계의 데이터는 경기 승패와 큰 상관이 없을 가능성이 크다.
예를 들어 3분 단계의 cs가 밀리는 현상은 단순 라인푸쉬가 밀려 빅웨이브를 받아먹는 타이밍이라 차이가 났을 가능성도 있다.
분 데이터 비대칭 문제와 극초반 수치 문제는 경기의 1/3에 해당하는 시간은 제외하고 분 데이터를 추출하는 등으로 간접적으로 조정할 수는 있지만,
일단 조정하지 않고 데이터셋을 만들어 학습에 사용하였다.
