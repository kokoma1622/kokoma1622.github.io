---
title: "[Diary] New Difference"
date: 2021-02-09 19:19:19 -0400
tags : [azure, Database]
categories: diary
---


작년 10월 이후 현재까지의 3달 동안의 변화를 정리한 글

우선 DB를 새로 만들었다.
기존에는 상위 티어의 랭크 게임만 받아왔다면, 전수조사를 시작.
모든 gameid를 검색해서, 한국 서버의 솔랭 데이터만 받아와서 DB에 넣었다.
다만 모든 솔랭 데이터를 받아온 것은 아니다.
일단 15분이 넘는 게임만 선택했고, 내가 코딩해놓은 포지션 배정에서 unspecified가 나오는 경우는 스킵.

데이터도 더 선별적으로 받아왔는데, 일단 api 과부하가 제일 많이 걸리는 평균 티어 부분을 아예 삭제했다.
현재 시점에서의 티어를 알아봐야 그 게임이 일어난 시점의 티어랑은 다르기도 하고.

그 다음 포지션 별로 DB를 분리했다. 
기존에 포지션 상관없이 한 DB에 테이블만 분리하니까 DB에 테이블이 너무 많아져, 애시당초 분리했다.
테이블도 중구난방이던걸 다소 정리해서, summary와 event, miunte를 없애고 14분 시점의 데이터만 담은 laning을 남겼다.
원래 minute table은 유지하려 했는데, DB에 데이터 전송하는데 시간이 오래걸려서 포기.

aws 쓰던걸 azure로 옮겼는데, 그러다보니 sql server를 쓰게된 것도 변화점이라면 변화점

10.24, 11.1을 완료했고 현재 11.2 데이터를 넣는 중.
아무래도 전수조사라 오래 걸린다. 하루에 대략 50만개의 조건에 맞는 게임 데이터를 DB에 넣는다.
대충 한 시간에 2만개 꼴?
